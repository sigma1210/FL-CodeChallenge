{"version":3,"sources":["fl-challenge.js","parser/fl-parser.js","viewer/fl-challenge-view.js","writer/fl-object-writer.js","flTemplateCache.js"],"names":["ng","module","angular","factory","_flParser","$log","$q","_parse","strToParse","resolve","reject","_deSerialize","_charIndex","len","_strToParse","length","_parseToken","charAt","_result","token","_handler","_tokenHandlers","isFunction","_curKey","_addKey","_stack","_peek","_clearCurrentKey","_startObject","_obj","push","_closeObject","pop","copy","KEY_DELIM_TOKEN","OBJECT_START_TOKEN","OBJECT_END_TOKEN","message","EMPTY_STRING_EXCEPTION","flParser","parse","component","templateUrl","controller","$filter","flObjectWriter","_self","this","error","result","test","then","printResults","write","sortedPrintResults","alphabetical","results","_flWriter","_write","object","mode","_print","obj","depth","_keys","_getSortedKeys","_output","_depthString","_getDepthString","forEach","key","SPACER","NEW_LINE","isObject","keys","Object","sort","_alphaSort","a","b","localeCompare","i","DEPTH_DELIM","_res","debug","NULL_OBJECT_EXCEPTION","ALPHABETICAL","e","run","$templateCache","put"],"mappings":"CAEA,SAAAA,GACA,YASAA,GAAAC,OAAA,gBAAA,gCACAC,SCXA,SAAAF,EAAAG,GACA,YAmCA,SAAAC,GAAAC,EAAAC,GAsBA,QAAAC,GAAAC,GACA,MAAAF,GAAA,SAAAG,EAAAC,GAkCA,QAAAC,KAEA,IAAA,GAAAC,GAAA,EAAAC,EAAAC,EAAAC,OAAAH,EAAAC,EAAAD,IACAI,EAAAF,EAAAG,OAAAL,GAGAH,GAAAS,GAYA,QAAAF,GAAAG,GAEA,GAAAC,GAAAC,EAAAF,EAEAnB,GAAAsB,WAAAF,GACAA,IACA,MAAAD,IAGAI,GAAAJ,GAgBA,QAAAK,KACAC,EAAAV,OAAA,GAAAQ,EAAAR,OAAA,IAEAW,IAAAH,GAAA,MAGAI,IAWA,QAAAC,KACA,GAAAC,KACAJ,GAAAV,OAAA,GAAAQ,EAAAR,OAAA,IAEAW,IAAAH,GAAAM,GAGAJ,EAAAK,KAAAD,GAEAF,IAYA,QAAAI,KAEAP,IACAN,EAAAO,EAAAO,MACAL,IAUA,QAAAD,KAEA,MAAAD,GAAAA,EAAAV,OAAA,GASA,QAAAY,KACAJ,EAAA,GA3IA,GAAAT,GAAAd,EAAAiC,KAAAzB,GACAe,EAAA,GACAE,KACAP,EAAA,KACAG,IAKAA,GAAAa,GAAAV,EACAH,EAAAc,GAAAP,EACAP,EAAAe,GAAAL,EAEAjB,EAOAH,IALAD,GACA2B,QAAAC,MAvCA,GAAAC,IACAC,MAAAjC,GAKA+B,EAAA,4DACAJ,EAAA,IACAC,EAAA,IACAC,EAAA,GAgKA,OAAAG,GA5KApC,EAAA,YAAA,OAAA,KAAAC,KA8KAF,QAAAA,QAAAD,OAAA,gBAAAE,SCnNA,SAAAH,EAAAyC,GACA,YAiBAA,GAAA,mBACAC,YAAA,iDACAC,YAAA,OAAA,UAAA,WAAA,iBAAA,SAAAtC,EAAAuC,EAAAL,EAAAM,GACA,GAAAC,GAAAC,IACAD,GAAAtC,WAAA,0EACAsC,EAAAE,MAAA,KACAF,EAAAG,OAAA,KACAH,EAAAI,KAAA,WACAX,EACAC,MAAAM,EAAAtC,YACA2C,KAAA,SAAAF,GACAH,EAAAE,MAAA,KACAF,EAAAG,OAAAA,EACAH,EAAAM,aAAAP,EAAAQ,MAAAJ,GACAH,EAAAQ,mBAAAT,EAAAQ,MAAAJ,EAAAJ,EAAAU,gBANAhB,SAQA,SAAAS,GACAF,EAAAE,MAAAA,EACAF,EAAAU,QAAA,KACAV,EAAAM,aAAA,GACAN,EAAAQ,mBAAA,GACAjD,EAAA2C,MAAAA,MAGAF,EAAAI,YAGAhD,QAAAA,QAAAD,OAAA,gBAAAwC,WC3CA,SAAAzC,EAAAG,GACA,YAeA,SAAAsD,GAAApD,GAyBA,QAAAqD,GAAAC,EAAAC,GAoBA,QAAAC,GAAAC,EAAAC,GACA,GAAAC,GAAAC,EAAAH,GACAI,EAAA,GACAC,EAAAC,EAAAL,EAcA,OAbA/D,GAAAqE,QAAAL,EAAA,SAAAM,GAEAP,EAAA,IAEAG,GAAAC,EAAAI,GAEAL,GAAAI,EAAAE,EAGAxE,EAAAyE,SAAAX,EAAAQ,MACAJ,GAAAL,EAAAC,EAAAQ,GAAAP,EAAA,MAGAG,EAWA,QAAAD,GAAAH,GAEA,GAAAY,GAAAC,OAAAD,KAAAZ,EAKA,OAJAF,IAAAf,EAAAU,cAEAmB,EAAAE,KAAAC,GAEAH,EAWA,QAAAG,GAAAC,EAAAC,GAEA,MAAAD,GAAAE,cAAAD,GAWA,QAAAX,GAAAL,GAEA,IAAA,GADAI,GAAA,GACAc,EAAA,EAAAA,EAAAlB,EAAAkB,IACAd,GAAAe,CAEA,OAAAf,GAnFA,GAAAR,EAGA,CACA,GAAAwB,GAAAtB,EAAAF,EAAA,EAEA,OADAtD,GAAA+E,MAAAD,GACAA,EAJA,MADA9E,GAAA2C,MAAAqC,GACA,GA1BA,GAAAA,GAAA,mCACAC,EAAA,eACAf,EAAA,IACAC,EAAA,OACAU,EAAA,IAEArC,GACAQ,MAAAK,EACAH,aAAA+B,EAuGA,OAAAzC,GAlHA1C,EAAA,kBAAA,OAAAsD,KAoHAvD,QAAAA,QAAAD,OAAA,gBAAAE,SCrIA,SAAAF,GACA,IACAA,EAAAC,QAAAD,OAAA,8BACA,MAAAsF,GACAtF,EAAAC,QAAAD,OAAA,iCAEAA,EAAAuF,KAAA,iBAAA,SAAAC,GACAA,EAAAC,IAAA,iDACA","file":"fl.challenge.min.js","sourcesContent":["\n// inject angular as ng from the global space into the closure\n(function(ng){\n  'use strict';\n  /**\n      *@ngdoc overview\n      *@name fl.challenge\n      *@description\n          an module which provides the solution the Front line code challenge\n          This code is placed in the root of the src directory to insure it appears on the top of the resultant\n          angular distrubution and minimized distribution file\n  */\n  ng.module('fl.challenge',['fl.challenge.templateCache']);\n})(angular);\n","//inject angular as ng\n//inject angular.module('fl.challenge').factory as factory\n(function(ng,factory){\n  'use strict';\n  /**\n   * @ngdoc service\n   * @name flParser\n   *\n   * @description\n      The flParser is a service which can parse nested delimeted strings in the form\n      (\n        foo,\n        bar(snaf, fu),\n        charlie,\n        foxtrot\n      )\n      into the javascript object\n      {\n        foo:null,\n        bar:{\n          snaf:null,\n          fu :null,\n        },\n        charlie:null,\n        foxtrot:null\n      }\n\n      Due to the nature of the overlapping delimeted normal methods of string\n      tokenizing such as String.split will not be useful\n\n      * @requires $log              What $rolls $down $stairs\n                                    $alone || in $pairs,\n                                    && $over your $neighbor's $dog?\n      * @requires $q                promises must be kept.\n      *\n      */\n\n  factory('flParser',['$log','$q', _flParser]);\n  function _flParser($log,$q){\n    //define the interface\n    var flParser={\n      parse:_parse,\n    };\n\n    // define error messages and delimeter tokens constants\n\n    var EMPTY_STRING_EXCEPTION  = 'The string provided was empty or null.It cannot be parsed',\n        KEY_DELIM_TOKEN         = ',',//the token that defines the end of an object key\n        OBJECT_START_TOKEN      = '(',//the token that defines the start of an object\n        OBJECT_END_TOKEN        = ')';// the token that defines the end of an object\n    /**\n    * @ngdoc function\n    * @name flParser.parse\n    * @param {string} strToParse the input string to parse\n    * @description\n    *   Parses a delimeted string into a javascript object\n    * @returns a promise to resolve a javascript object represention the string to be parse or rejecting\n    * with a defined error\n    *\n  */\n    function _parse(strToParse) {\n      return $q(function(resolve,reject){\n\n            var _strToParse = ng.copy(strToParse),// clone the string to a local var\n            _curKey ='',    // the current key being read\n            _stack =[],     // a stack to manage the object hierarcy\n            _result = null, // object containing the deserialixed srting\n            _tokenHandlers = {};//a hash set of token handlers\n            //create a hash for the special tokens to parse\n            //akin to SAX type xml parser define handlers for the tokens\n            //in this example there are only 3 tokens which require handling\n\n            _tokenHandlers[KEY_DELIM_TOKEN]    = _addKey;//handler the end key token\n            _tokenHandlers[OBJECT_START_TOKEN] = _startObject;//handle the start of an object\n            _tokenHandlers[OBJECT_END_TOKEN]   = _closeObject;// handler the end of an object\n\n            if(!_strToParse){\n              // if there is no string to parse reject with error message\n              reject({\n                message: EMPTY_STRING_EXCEPTION\n              });\n            }else{\n\n              _deSerialize();\n            }\n            /**\n            * @ngdoc private function\n            * @name _deSerialize\n            * @description\n            *    iterates through each character in string to parse and calls the _parseToken method to determine how the token\n            *    should be handler based on the tokenHandler hashset for the corresponding token. Once all tokens are handled\n            *    resolves the promise with the last well form object parse\n            * @returns null\n            */\n\n            function _deSerialize(){\n                // read forward throw the string one char at a time\n                for(var _charIndex =0, len = _strToParse.length;_charIndex<len;_charIndex++ ){\n                  _parseToken(_strToParse.charAt(_charIndex));\n                }\n                // _result is the last valid object parsed\n                resolve(_result);\n            }\n\n            /**\n            * @ngdoc private function\n            * @name _parseToken\n            * @param {string} token the current token being handled\n            * @description\n            *    check to see if there is a handler for the current token. if the token has a handler the handler is executed.\n            *    Otherwise a key is still being read -- spaces are ignored.\n            * @returns null\n            */\n            function _parseToken(token){\n              //get the cooresponding handler from the charHandlers hash\n              var _handler = _tokenHandlers[token];\n              //if it exists and it is a function execute it\n              if (ng.isFunction(_handler)) {\n                _handler();\n              } else if (' ' !== token) {\n                  //ignore spaces -- this will concatinate keys with spaces which are invalid\n                  //todo extend to include all white spaces\n                  _curKey += token;\n              }\n            }\n\n\n            /**\n            * @ngdoc private function\n            * @name _addKey\n            * @description\n            *  A handler function that is called when a key end delimeted is being handler or when an object end token is being handler.\n            *  The function gets the last object place on the stack and adds a hash with the name of the current key being handled.\n            *  rests the current key when complete\n            *\n            * @returns null\n            */\n\n            function _addKey(){\n              if ( _stack.length > 0 && _curKey.length > 0) {\n                //set the a new hash\n                _peek()[_curKey] = null;\n              }\n              //clear the current key\n              _clearCurrentKey();\n            }\n            /**\n            * @ngdoc private function\n            * @name _startObject\n            * @description\n            *  A handler function that is called when a key a start object token is being read\n            *  a new object is created and is set to the hash of the current Key on te last object in the stack\n            *  pushes the object on the statck such that all subsequent calls act on the new object until a close object token is handled\n            * @returns null\n            */\n            function _startObject(){\n              var _obj = {};\n              if(_stack.length > 0 && _curKey.length >0){\n                //set the new hash to be the new object\n                _peek()[_curKey] = _obj;\n              }\n              //push it onto stack so that it will be return by _peek()\n              _stack.push(_obj);\n                //clear the current key\n              _clearCurrentKey();\n            }\n\n\n            /**\n            * @ngdoc private function\n            * @name _closeObject\n            * @description\n            *  A handler function that is called when a  close object token is being read\n            *  it adds a new key is needed, pops the object off the stack and clears the current key\n            * @returns null\n            */\n            function _closeObject(){\n              //add key is needed\n              _addKey();\n              _result = _stack.pop();\n              _clearCurrentKey();\n            }\n\n            /**\n            * @ngdoc private function\n            * @name _peek\n            * @description\n            * returns the last object place on the stack without removing it\n            * @returns the last object pushed on the stack\n            */\n            function _peek(){\n              // return last object on the statck\n              return _stack[_stack.length - 1];\n            }\n            /**\n            * @ngdoc private function\n            * @name _clearCurrentKey\n            * @description\n            * resets the currentKey to '' so that a new key can be read\n            * @returns null\n            */\n            function _clearCurrentKey(){\n              _curKey= \"\";\n            }\n\n      });\n    }\n\n\n    return flParser;\n  }\n})(angular, angular.module('fl.challenge').factory);\n","(function(ng,component){\n  'use strict';\n  /**\n   * @ngdoc component\n   * @name flChallengeView\n   * @memberof fl.challenge\n   * @requires $log                - can't live without $log\n   * @requires $filter             - provide access to json filter\n   * @requires flParser            - the string parser service used in the challenge\n   * @requires flObjectWriter      - the objevt writer that can output an hrml representation of the string\n   *                                  html injection\n\n   * @restrict E\n   * @description\n        a directive used to display the results of the Front line challeneg\n   * @example\n      <fl:challenge:view/>\n  **/\n  component('flChallengeView',{\n      templateUrl:'flTemplateCache:/viewer/fl-challenge-view.html',\n      controller:['$log','$filter','flParser','flObjectWriter', function($log,$filter,flParser,flObjectWriter){\n        var _self = this;\n        _self.strToParse = \"(id,created,employee(id,firstname,employeeType(id), lastname),location)\";\n        _self.error=null;\n        _self.result = null;\n        _self.test = function(){\n          flParser\n            .parse(_self.strToParse)\n            .then(function(result){\n              _self.error=null;\n              _self.result = result;\n              _self.printResults = flObjectWriter.write(result);\n              _self.sortedPrintResults = flObjectWriter.write(result,flObjectWriter.alphabetical);\n            })\n            .catch(function(error){\n              _self.error=error;\n              _self.results = null;\n              _self.printResults = '';\n              _self.sortedPrintResults='';\n              $log.error(error);\n            });\n        };\n        _self.test();\n      }]\n  });\n})(angular,angular.module('fl.challenge').component);\n","//inject angular as ng\n//inject angular.module('fl.challenge').factory as factory\n(function(ng,factory){\n  'use strict';\n  /**\n   * @ngdoc service\n   * @name flObJectWriter\n   *\n   * @description\n   *   write the keys of a javascript object out as a string such that\n   *   each key is written with 2 newline characters, if the key points to a child object the child object\n   *   is also written with a number of '-' equal to the depth of the object with in the object graph.\n   *   Sort order can be specified, in which case the objects key will be sorted alphabetically\n   * @requires $log          $its $great for a $snack $it $fits on $your $back\n   *                         $its $log,$log,$log\n */\n\n  factory('flObjectWriter',['$log', _flWriter]);\n  function _flWriter($log){\n\n    var NULL_OBJECT_EXCEPTION =\"No object was specified to write\",\n        ALPHABETICAL = \"ALPHABETICAL\",\n        SPACER= \" \", // non breaking space\n        NEW_LINE =\"\\n\\n\",// double spaced\n        DEPTH_DELIM ='-';// prefix used in displaying hierarcy\n    //define the interface\n    var flObjectWriter={\n      write:_write,\n      alphabetical:ALPHABETICAL\n    };\n    /**\n    * @ngdoc function\n    * @name flObjectWriter.write\n    * @param {object} object the object to write\n    * @param {string} mode option parameter to determine the order of the output\n    *\n    * @description\n    *   creates a string representation of object by iterating through each key within the object\n    *   if the mode is equal to flObjectWriter.alphabetical the keys are outputted in alphabetical order.\n    *   otherwise the are written in the order they are encountered.\n    * @returns a string represetion of the object\n    *\n    */\n    function _write(object,mode){\n        if(!object){\n          $log.error(NULL_OBJECT_EXCEPTION);\n          return('');\n        }else{\n          var _res =_print(object,0);\n          $log.debug(_res);\n          return _res;\n        }\n        /**\n        * @ngdoc private function\n        * @name _print\n        * @param {object} obj the object to write\n        * @param {int} depth the depth of the current object in the hierarchy\n        * @description\n        *  a recursive function used to iterate through each key within the object\n        *  being printed\n        * @returns a string represention of the object\n        */\n\n        function _print(obj, depth){\n          var _keys = _getSortedKeys(obj),//an array of keys sorted according to mode\n              _output = '',//the string to hold the output\n              _depthString = _getDepthString(depth);//the depth prefix\n          ng.forEach(_keys,function(key){\n            //iterate through each key\n             if (depth > 0) {\n               //prefix with depth string\n               _output += _depthString + SPACER ;\n             }\n             _output += key + NEW_LINE;\n             // if and only if the current key points to an object call the function recursively\n             // with the child object and a incremeneted depth\n            if(ng.isObject(obj[key])){\n              _output += _print(obj[key], depth + 1);\n            }\n           });\n          return _output;\n        }\n        /**\n        * @ngdoc private function\n        * @name _getSortedKeys\n        * @param {object} obj the object to write\n\n        * @description\n        *  creates an array of key names presented in the sort order defined in the current mode\n        * @returns an array of keynames sorted according to mode\n        */\n        function _getSortedKeys(obj) {\n          // ask for an arrsy of keys\n          var keys = Object.keys(obj);\n          if (mode == flObjectWriter.alphabetical) {\n            // sort use _alphaSort if the mode is equal to flObjectWriter.alphabetical\n            keys.sort(_alphaSort);\n          }\n          return keys;\n        }\n        /**\n        * @ngdoc private function\n        * @name _alphaSort\n        * @param {string} a the first element to compare\n        * @param {string} b the second element to compare\n        * @description\n        *  a generic comparer function used within the array sort to the elements alphabetical based on current localization\n        * @returns returns true if the value of a comes before b\n        */\n        function _alphaSort(a,b){\n          // standard localized compare\n          return a.localeCompare(b);\n        }\n        /**\n        * @ngdoc private function\n        * @name _getDepthString\n        * @param {int} depth the depth of the current OBJECT_END_TOKEN\n        * @description\n        *  create a string with a number of depth delimeters equql to the depth specified\n        * @returns a string with make up of depth number of depth delimeters\n        */\n\n        function _getDepthString(depth){\n          var _depthString = \"\";\n          for (var i = 0; i < depth; i++) {\n            _depthString += DEPTH_DELIM;\n          }\n          return _depthString;\n        }\n    }\n\n    return flObjectWriter;\n  }\n})(angular, angular.module('fl.challenge').factory);\n","(function(module) {\ntry {\n  module = angular.module('fl.challenge.templateCache');\n} catch (e) {\n  module = angular.module('fl.challenge.templateCache', []);\n}\nmodule.run(['$templateCache', function($templateCache) {\n  $templateCache.put('flTemplateCache:/viewer/fl-challenge-view.html',\n    '<div class=\"well\"><h2>Frontline Education Code Challenge</h2><p>A complete tested soultion to the challenge. Coverage reports can be viewed at <a href=\"coverage/html/index.html\" target=\"_blank\">here</a>.</p><div class=\"input-group\"><input type=\"text\" class=\"form-control\" ng-model=\"$ctrl.strToParse\"> <span class=\"input-group-btn\"><button class=\"btn btn-default\" type=\"button\" ng-click=\"$ctrl.test()\">Parse!</button></span></div><div class=\"row\"><div class=\"col-sm-6\"><h3>formatted output:</h3><pre class=\"pre-scrollable\">{{$ctrl.printResults}}</pre></div><div class=\"col-sm-6\"><h3>Bonus (output in alphabetical order):</h3><pre class=\"pre-scrollable\">{{$ctrl.sortedPrintResults}}</pre></div></div><div class=\"row\"><h3>The parsed object in json format</h3><pre class=\"pre-scrollable\">{{$ctrl.result|json}}\\n' +\n    '  </pre></div></div>');\n}]);\n})();\n"]}